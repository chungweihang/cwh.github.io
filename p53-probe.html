<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script language="javascript" type="text/javascript">
function startsWith(str, suffix)
{
    return (str.indexOf(suffix) === 0);
}

function endsWith(str, suffix) 
{
    return str.indexOf(suffix, str.length - suffix.length) !== -1;
}

function count(str, suffix)
{
    return (str.split(suffix).length - 1)
}

function analyze()
{
    var result = document.getElementById('result');
    result.innerHTML = "";
    var string = document.myform.seq.value;
    string = string.replace(/\s/g, "");
    for (i = 40; i <= 46; i++)
    {
	for (j = 0; j < string.length; j++)
	{
	    if (j + i > string.length) 
	    {
		break;
	    }

	    var substr = string.substring(j, j+i);

	    // rule 2 & 3 & 5
            if (startsWith(substr, "G") || endsWith(substr, "T") || endsWith(substr, "GG") || endsWith(substr, "CC"))
	    {
		continue;
            }

	    // rule 6
	    if (count(substr, "C") > count(substr, "G"))
            {
                continue;
            }

            // rule 1
            var GandC = count(substr, "C") + count(substr, "G");
            if (GandC < 0.5*i || GandC > 0.6*i)
            {
                continue;
            }

            // rule 4
            if (substr.match(/(G)\1{3,}/g) != null)
            {
                continue;
            }

	    result.innerHTML = result.innerHTML + substr.length + ' [' + (GandC/i) + ']: ' + substr + '</br>'
        }
    }
}

function test()
{
    var string = document.myform.seq.value;
    alert(string.match(/(C)\1{3,}/g));
}
</script>
</head>
<body>
<form name="myform">
<textarea rows="20" cols="100" name="seq">
</textarea>
<input type="button" value="Analyze" onClick="analyze();">
</form>
<b id='result'></b>
</body>
</html>
